Loading data...
x_train shape: (20146, 250)
x_test shape: (2238, 250)
y_train shape: (20146,)
y_test shape: (2238,)
word vector dimension 50
Build model RNN...
Train RNN...
Train on 20146 samples, validate on 2238 samples
Epoch 1/50
 - 62s - loss: 0.6567 - acc: 0.6139 - val_loss: 0.7030 - val_acc: 0.5719
Epoch 2/50
 - 71s - loss: 0.6528 - acc: 0.6176 - val_loss: 0.5835 - val_acc: 0.7011
Epoch 3/50
 - 71s - loss: 0.6671 - acc: 0.5844 - val_loss: 0.6897 - val_acc: 0.5478
Epoch 4/50
 - 72s - loss: 0.6671 - acc: 0.5943 - val_loss: 0.6055 - val_acc: 0.6823
Epoch 5/50
 - 71s - loss: 0.6685 - acc: 0.5910 - val_loss: 0.6891 - val_acc: 0.5237
Epoch 6/50
 - 70s - loss: 0.6721 - acc: 0.5838 - val_loss: 0.6516 - val_acc: 0.6144
Epoch 7/50
 - 71s - loss: 0.6547 - acc: 0.6129 - val_loss: 0.5737 - val_acc: 0.7172
Epoch 8/50
 - 71s - loss: 0.6450 - acc: 0.6310 - val_loss: 0.6031 - val_acc: 0.6854
Epoch 9/50
 - 71s - loss: 0.6440 - acc: 0.6315 - val_loss: 0.6192 - val_acc: 0.6510
Epoch 10/50
 - 71s - loss: 0.6309 - acc: 0.6519 - val_loss: 0.6862 - val_acc: 0.5608
Epoch 11/50
 - 71s - loss: 0.6326 - acc: 0.6437 - val_loss: 0.6208 - val_acc: 0.6466
Epoch 12/50
 - 70s - loss: 0.6365 - acc: 0.6367 - val_loss: 0.6478 - val_acc: 0.6162
Epoch 13/50
 - 70s - loss: 0.6371 - acc: 0.6409 - val_loss: 0.6315 - val_acc: 0.6461
Epoch 14/50
 - 71s - loss: 0.6123 - acc: 0.6692 - val_loss: 0.6085 - val_acc: 0.6693
Epoch 15/50
 - 71s - loss: 0.6356 - acc: 0.6351 - val_loss: 0.5608 - val_acc: 0.7239
Epoch 16/50
 - 71s - loss: 0.6160 - acc: 0.6623 - val_loss: 0.6776 - val_acc: 0.5590
Epoch 17/50
 - 70s - loss: 0.6464 - acc: 0.6268 - val_loss: 0.6207 - val_acc: 0.6550
Epoch 18/50
 - 70s - loss: 0.6437 - acc: 0.6214 - val_loss: 0.6072 - val_acc: 0.6711
Epoch 19/50
 - 71s - loss: 0.6361 - acc: 0.6409 - val_loss: 0.6274 - val_acc: 0.6483
Epoch 20/50
 - 70s - loss: 0.6454 - acc: 0.6204 - val_loss: 0.5973 - val_acc: 0.6783
Epoch 21/50
 - 71s - loss: 0.6281 - acc: 0.6461 - val_loss: 0.5839 - val_acc: 0.7011
Epoch 22/50
 - 71s - loss: 0.6349 - acc: 0.6402 - val_loss: 0.5983 - val_acc: 0.6939
Epoch 23/50
 - 70s - loss: 0.6309 - acc: 0.6436 - val_loss: 0.7382 - val_acc: 0.5259
Epoch 24/50
 - 70s - loss: 0.6521 - acc: 0.6139 - val_loss: 0.6592 - val_acc: 0.5965
Epoch 25/50
 - 69s - loss: 0.6482 - acc: 0.6102 - val_loss: 0.6350 - val_acc: 0.6327
Epoch 26/50
 - 70s - loss: 0.6378 - acc: 0.6303 - val_loss: 0.6389 - val_acc: 0.6197
Epoch 27/50
 - 70s - loss: 0.6381 - acc: 0.6271 - val_loss: 0.6177 - val_acc: 0.6421
Epoch 28/50
 - 70s - loss: 0.6360 - acc: 0.6350 - val_loss: 0.6434 - val_acc: 0.6340
Epoch 29/50
 - 70s - loss: 0.6289 - acc: 0.6433 - val_loss: 0.6188 - val_acc: 0.6564
Epoch 30/50
 - 70s - loss: 0.6580 - acc: 0.5904 - val_loss: 0.6584 - val_acc: 0.5894
Epoch 31/50
 - 69s - loss: 0.6545 - acc: 0.6031 - val_loss: 0.6405 - val_acc: 0.6296
Epoch 32/50
 - 69s - loss: 0.6509 - acc: 0.6147 - val_loss: 0.6482 - val_acc: 0.5996
Epoch 33/50
 - 70s - loss: 0.6349 - acc: 0.6354 - val_loss: 0.5802 - val_acc: 0.7038
Epoch 34/50
 - 70s - loss: 0.6473 - acc: 0.6173 - val_loss: 0.6172 - val_acc: 0.6635
Epoch 35/50
 - 70s - loss: 0.6342 - acc: 0.6336 - val_loss: 0.6515 - val_acc: 0.6376
Epoch 36/50
 - 69s - loss: 0.6600 - acc: 0.6019 - val_loss: 0.6435 - val_acc: 0.6135
Epoch 37/50
 - 70s - loss: 0.6312 - acc: 0.6390 - val_loss: 0.6227 - val_acc: 0.6577
Epoch 38/50
 - 70s - loss: 0.6316 - acc: 0.6387 - val_loss: 0.6088 - val_acc: 0.6519
Epoch 39/50
 - 70s - loss: 0.6270 - acc: 0.6389 - val_loss: 0.6120 - val_acc: 0.6488
Epoch 40/50
 - 70s - loss: 0.6416 - acc: 0.6185 - val_loss: 0.6369 - val_acc: 0.6385
Epoch 41/50
 - 69s - loss: 0.6400 - acc: 0.6306 - val_loss: 0.6319 - val_acc: 0.6282
Epoch 42/50
 - 70s - loss: 0.6299 - acc: 0.6435 - val_loss: 0.6140 - val_acc: 0.6524
Epoch 43/50
 - 70s - loss: 0.6327 - acc: 0.6357 - val_loss: 0.5494 - val_acc: 0.7203
Epoch 44/50
 - 70s - loss: 0.6116 - acc: 0.6674 - val_loss: 0.5510 - val_acc: 0.7189
Epoch 45/50
 - 69s - loss: 0.6745 - acc: 0.5846 - val_loss: 0.6596 - val_acc: 0.5996
Epoch 46/50
 - 70s - loss: 0.6500 - acc: 0.6136 - val_loss: 0.6554 - val_acc: 0.6171
Epoch 47/50
 - 70s - loss: 0.6392 - acc: 0.6271 - val_loss: 0.6088 - val_acc: 0.6756
Epoch 48/50
 - 70s - loss: 0.6307 - acc: 0.6408 - val_loss: 0.5582 - val_acc: 0.7248
Epoch 49/50
 - 70s - loss: 0.6496 - acc: 0.6097 - val_loss: 0.6264 - val_acc: 0.6613
Epoch 50/50
 - 70s - loss: 0.6301 - acc: 0.6367 - val_loss: 0.5926 - val_acc: 0.6810

 128/2238 [>.............................] - ETA: 2s
 256/2238 [==>...........................] - ETA: 2s
 384/2238 [====>.........................] - ETA: 2s
 512/2238 [=====>........................] - ETA: 2s
 640/2238 [=======>......................] - ETA: 2s
 768/2238 [=========>....................] - ETA: 1s
 896/2238 [===========>..................] - ETA: 1s
1024/2238 [============>.................] - ETA: 1s
1152/2238 [==============>...............] - ETA: 1s
1280/2238 [================>.............] - ETA: 1s
1408/2238 [=================>............] - ETA: 1s
1536/2238 [===================>..........] - ETA: 0s
1664/2238 [=====================>........] - ETA: 0s
1792/2238 [=======================>......] - ETA: 0s
1920/2238 [========================>.....] - ETA: 0s
2048/2238 [==========================>...] - ETA: 0s
2176/2238 [============================>.] - ETA: 0s
2238/2238 [==============================] - 3s 1ms/step
Test score: 0.5925788262574346
Test accuracy: 0.6809651472932852
Saved model to disk
Build model GRU...
Train GRU...
Train on 20146 samples, validate on 2238 samples
Epoch 1/50
 - 228s - loss: 0.6049 - acc: 0.6675 - val_loss: 0.4226 - val_acc: 0.8097
Epoch 2/50
 - 227s - loss: 0.4558 - acc: 0.7893 - val_loss: 0.3312 - val_acc: 0.8637
Epoch 3/50
 - 227s - loss: 0.3643 - acc: 0.8410 - val_loss: 0.2694 - val_acc: 0.8838
Epoch 4/50
 - 227s - loss: 0.3209 - acc: 0.8659 - val_loss: 0.2413 - val_acc: 0.9026
Epoch 5/50
 - 227s - loss: 0.2972 - acc: 0.8763 - val_loss: 0.2262 - val_acc: 0.9080
Epoch 6/50
 - 227s - loss: 0.2763 - acc: 0.8840 - val_loss: 0.2092 - val_acc: 0.9178
Epoch 7/50
 - 227s - loss: 0.2557 - acc: 0.8929 - val_loss: 0.1969 - val_acc: 0.9205
Epoch 8/50
 - 227s - loss: 0.2451 - acc: 0.8988 - val_loss: 0.2251 - val_acc: 0.9093
Epoch 9/50
 - 227s - loss: 0.2423 - acc: 0.9006 - val_loss: 0.1916 - val_acc: 0.9231
Epoch 10/50
 - 236s - loss: 0.2286 - acc: 0.9082 - val_loss: 0.1799 - val_acc: 0.9294
Epoch 11/50
 - 228s - loss: 0.2191 - acc: 0.9112 - val_loss: 0.2011 - val_acc: 0.9160
Epoch 12/50
 - 228s - loss: 0.2112 - acc: 0.9134 - val_loss: 0.1898 - val_acc: 0.9285
Epoch 13/50
 - 228s - loss: 0.1942 - acc: 0.9189 - val_loss: 0.1785 - val_acc: 0.9294
Epoch 14/50
 - 228s - loss: 0.1951 - acc: 0.9204 - val_loss: 0.1806 - val_acc: 0.9249
Epoch 15/50
 - 228s - loss: 0.1883 - acc: 0.9247 - val_loss: 0.1735 - val_acc: 0.9267
Epoch 16/50
 - 228s - loss: 0.1763 - acc: 0.9286 - val_loss: 0.1699 - val_acc: 0.9316
Epoch 17/50
 - 228s - loss: 0.1752 - acc: 0.9292 - val_loss: 0.1702 - val_acc: 0.9321
Epoch 18/50
 - 228s - loss: 0.1665 - acc: 0.9336 - val_loss: 0.1683 - val_acc: 0.9357
Epoch 19/50
 - 228s - loss: 0.1618 - acc: 0.9367 - val_loss: 0.1689 - val_acc: 0.9330
Epoch 20/50
 - 228s - loss: 0.1539 - acc: 0.9374 - val_loss: 0.1683 - val_acc: 0.9312
Epoch 21/50
 - 228s - loss: 0.1519 - acc: 0.9389 - val_loss: 0.1740 - val_acc: 0.9352
Epoch 22/50
 - 228s - loss: 0.1508 - acc: 0.9399 - val_loss: 0.1704 - val_acc: 0.9352
Epoch 23/50
 - 228s - loss: 0.1452 - acc: 0.9427 - val_loss: 0.1641 - val_acc: 0.9316
Epoch 24/50
 - 228s - loss: 0.1402 - acc: 0.9444 - val_loss: 0.1693 - val_acc: 0.9366
Epoch 25/50
 - 228s - loss: 0.1337 - acc: 0.9457 - val_loss: 0.1745 - val_acc: 0.9392
Epoch 26/50
 - 228s - loss: 0.1337 - acc: 0.9470 - val_loss: 0.1657 - val_acc: 0.9343
Epoch 27/50
 - 228s - loss: 0.1268 - acc: 0.9478 - val_loss: 0.1785 - val_acc: 0.9348
Epoch 28/50
 - 228s - loss: 0.1227 - acc: 0.9529 - val_loss: 0.1765 - val_acc: 0.9352
Epoch 29/50
 - 228s - loss: 0.1217 - acc: 0.9521 - val_loss: 0.1696 - val_acc: 0.9406
Epoch 30/50
 - 228s - loss: 0.1170 - acc: 0.9535 - val_loss: 0.1682 - val_acc: 0.9370
Epoch 31/50
 - 228s - loss: 0.1134 - acc: 0.9582 - val_loss: 0.1703 - val_acc: 0.9352
Epoch 32/50
 - 228s - loss: 0.1129 - acc: 0.9554 - val_loss: 0.1756 - val_acc: 0.9348
Epoch 33/50
 - 228s - loss: 0.1074 - acc: 0.9573 - val_loss: 0.1777 - val_acc: 0.9352
Epoch 34/50
 - 228s - loss: 0.1074 - acc: 0.9572 - val_loss: 0.1831 - val_acc: 0.9361
Epoch 35/50
 - 228s - loss: 0.1019 - acc: 0.9597 - val_loss: 0.1679 - val_acc: 0.9397
Epoch 36/50
 - 228s - loss: 0.0996 - acc: 0.9611 - val_loss: 0.1806 - val_acc: 0.9419
Epoch 37/50
 - 228s - loss: 0.1016 - acc: 0.9598 - val_loss: 0.1754 - val_acc: 0.9370
Epoch 38/50
 - 228s - loss: 0.0979 - acc: 0.9625 - val_loss: 0.1691 - val_acc: 0.9388
Epoch 39/50
 - 228s - loss: 0.0940 - acc: 0.9655 - val_loss: 0.1869 - val_acc: 0.9343
Epoch 40/50
 - 228s - loss: 0.0912 - acc: 0.9656 - val_loss: 0.1774 - val_acc: 0.9410
Epoch 41/50
 - 228s - loss: 0.0907 - acc: 0.9653 - val_loss: 0.1834 - val_acc: 0.9397
Epoch 42/50
 - 228s - loss: 0.0910 - acc: 0.9639 - val_loss: 0.1807 - val_acc: 0.9330
Epoch 43/50
 - 228s - loss: 0.0903 - acc: 0.9650 - val_loss: 0.1735 - val_acc: 0.9379
Epoch 44/50
 - 228s - loss: 0.0852 - acc: 0.9675 - val_loss: 0.2053 - val_acc: 0.9330
Epoch 45/50
 - 228s - loss: 0.0827 - acc: 0.9673 - val_loss: 0.1738 - val_acc: 0.9370
Epoch 46/50
 - 228s - loss: 0.0775 - acc: 0.9701 - val_loss: 0.1986 - val_acc: 0.9383
Epoch 47/50
 - 228s - loss: 0.0810 - acc: 0.9682 - val_loss: 0.1995 - val_acc: 0.9352
Epoch 48/50
 - 228s - loss: 0.0821 - acc: 0.9672 - val_loss: 0.1799 - val_acc: 0.9397
Epoch 49/50
 - 228s - loss: 0.0773 - acc: 0.9709 - val_loss: 0.1844 - val_acc: 0.9361
Epoch 50/50
 - 228s - loss: 0.0797 - acc: 0.9707 - val_loss: 0.1852 - val_acc: 0.9374

 128/2238 [>.............................] - ETA: 7s
 256/2238 [==>...........................] - ETA: 6s
 384/2238 [====>.........................] - ETA: 6s
 512/2238 [=====>........................] - ETA: 5s
 640/2238 [=======>......................] - ETA: 5s
 768/2238 [=========>....................] - ETA: 5s
 896/2238 [===========>..................] - ETA: 4s
1024/2238 [============>.................] - ETA: 4s
1152/2238 [==============>...............] - ETA: 3s
1280/2238 [================>.............] - ETA: 3s
1408/2238 [=================>............] - ETA: 2s
1536/2238 [===================>..........] - ETA: 2s
1664/2238 [=====================>........] - ETA: 1s
1792/2238 [=======================>......] - ETA: 1s
1920/2238 [========================>.....] - ETA: 1s
2048/2238 [==========================>...] - ETA: 0s
2176/2238 [============================>.] - ETA: 0s
2238/2238 [==============================] - 8s 3ms/step
Test score: 0.18524695153850013
Test accuracy: 0.937444146612694
Saved model to disk
Build model LSTM...
Train LSTM...
Train on 20146 samples, validate on 2238 samples
Epoch 1/50
 - 290s - loss: 0.6019 - acc: 0.6729 - val_loss: 0.5007 - val_acc: 0.7784
Epoch 2/50
 - 289s - loss: 0.5488 - acc: 0.7248 - val_loss: 0.4688 - val_acc: 0.7793
Epoch 3/50
 - 289s - loss: 0.4996 - acc: 0.7572 - val_loss: 0.4188 - val_acc: 0.8065
Epoch 4/50
 - 289s - loss: 0.4326 - acc: 0.7985 - val_loss: 0.3359 - val_acc: 0.8534
Epoch 5/50
 - 289s - loss: 0.3787 - acc: 0.8338 - val_loss: 0.2863 - val_acc: 0.8843
Epoch 6/50
 - 289s - loss: 0.3430 - acc: 0.8495 - val_loss: 0.2722 - val_acc: 0.8901
Epoch 7/50
 - 291s - loss: 0.3303 - acc: 0.8543 - val_loss: 0.2584 - val_acc: 0.8928
Epoch 8/50
 - 291s - loss: 0.3036 - acc: 0.8709 - val_loss: 0.2276 - val_acc: 0.9071
Epoch 9/50
 - 289s - loss: 0.2887 - acc: 0.8785 - val_loss: 0.2227 - val_acc: 0.9129
Epoch 10/50
 - 290s - loss: 0.2774 - acc: 0.8823 - val_loss: 0.2154 - val_acc: 0.9178
Epoch 11/50
 - 290s - loss: 0.2638 - acc: 0.8915 - val_loss: 0.2191 - val_acc: 0.9115
Epoch 12/50
 - 290s - loss: 0.2550 - acc: 0.8926 - val_loss: 0.1962 - val_acc: 0.9209
Epoch 13/50
 - 290s - loss: 0.2460 - acc: 0.8992 - val_loss: 0.2221 - val_acc: 0.9102
Epoch 14/50
 - 290s - loss: 0.2401 - acc: 0.9002 - val_loss: 0.1911 - val_acc: 0.9258
Epoch 15/50
 - 288s - loss: 0.2307 - acc: 0.9043 - val_loss: 0.1976 - val_acc: 0.9223
Epoch 16/50
 - 288s - loss: 0.2208 - acc: 0.9085 - val_loss: 0.1817 - val_acc: 0.9312
Epoch 17/50
 - 288s - loss: 0.2188 - acc: 0.9089 - val_loss: 0.1765 - val_acc: 0.9298
Epoch 18/50
 - 288s - loss: 0.2105 - acc: 0.9157 - val_loss: 0.1826 - val_acc: 0.9325
Epoch 19/50
 - 288s - loss: 0.2036 - acc: 0.9162 - val_loss: 0.1875 - val_acc: 0.9303
Epoch 20/50
 - 288s - loss: 0.1970 - acc: 0.9207 - val_loss: 0.1720 - val_acc: 0.9370
Epoch 21/50
 - 288s - loss: 0.1890 - acc: 0.9248 - val_loss: 0.1681 - val_acc: 0.9366
Epoch 22/50
 - 288s - loss: 0.1858 - acc: 0.9263 - val_loss: 0.1710 - val_acc: 0.9406
Epoch 23/50
 - 288s - loss: 0.1770 - acc: 0.9276 - val_loss: 0.1720 - val_acc: 0.9374
Epoch 24/50
 - 288s - loss: 0.1744 - acc: 0.9297 - val_loss: 0.1979 - val_acc: 0.9249
Epoch 25/50
 - 288s - loss: 0.1702 - acc: 0.9303 - val_loss: 0.1684 - val_acc: 0.9383
Epoch 26/50
 - 288s - loss: 0.1627 - acc: 0.9347 - val_loss: 0.1650 - val_acc: 0.9401
Epoch 27/50
 - 288s - loss: 0.1563 - acc: 0.9371 - val_loss: 0.1834 - val_acc: 0.9334
Epoch 28/50
 - 288s - loss: 0.1535 - acc: 0.9379 - val_loss: 0.1782 - val_acc: 0.9392
Epoch 29/50
 - 294s - loss: 0.1509 - acc: 0.9400 - val_loss: 0.1768 - val_acc: 0.9379
Epoch 30/50
 - 299s - loss: 0.1430 - acc: 0.9453 - val_loss: 0.1682 - val_acc: 0.9374
Epoch 31/50
 - 291s - loss: 0.1432 - acc: 0.9419 - val_loss: 0.1800 - val_acc: 0.9334
Epoch 32/50
 - 291s - loss: 0.1353 - acc: 0.9486 - val_loss: 0.1803 - val_acc: 0.9339
Epoch 33/50
 - 291s - loss: 0.1323 - acc: 0.9468 - val_loss: 0.1852 - val_acc: 0.9352
Epoch 34/50
 - 291s - loss: 0.1326 - acc: 0.9475 - val_loss: 0.1760 - val_acc: 0.9361
Epoch 35/50
 - 292s - loss: 0.1296 - acc: 0.9483 - val_loss: 0.1837 - val_acc: 0.9330
Epoch 36/50
 - 291s - loss: 0.1223 - acc: 0.9528 - val_loss: 0.1733 - val_acc: 0.9397
Epoch 37/50
 - 292s - loss: 0.1186 - acc: 0.9539 - val_loss: 0.1755 - val_acc: 0.9379
Epoch 38/50
 - 291s - loss: 0.1147 - acc: 0.9559 - val_loss: 0.1726 - val_acc: 0.9388
Epoch 39/50
 - 291s - loss: 0.1126 - acc: 0.9543 - val_loss: 0.1789 - val_acc: 0.9388
Epoch 40/50
 - 289s - loss: 0.1637 - acc: 0.9332 - val_loss: 0.2635 - val_acc: 0.8865
Epoch 41/50
 - 289s - loss: 0.1722 - acc: 0.9306 - val_loss: 0.2095 - val_acc: 0.9227
Epoch 42/50
 - 289s - loss: 0.1417 - acc: 0.9442 - val_loss: 0.1781 - val_acc: 0.9370
Epoch 43/50
 - 289s - loss: 0.1191 - acc: 0.9539 - val_loss: 0.1943 - val_acc: 0.9312
Epoch 44/50
 - 289s - loss: 0.1125 - acc: 0.9563 - val_loss: 0.1793 - val_acc: 0.9388
Epoch 45/50
 - 289s - loss: 0.1081 - acc: 0.9577 - val_loss: 0.1847 - val_acc: 0.9401
Epoch 46/50
 - 290s - loss: 0.1072 - acc: 0.9568 - val_loss: 0.1934 - val_acc: 0.9343
Epoch 47/50
 - 292s - loss: 0.1031 - acc: 0.9601 - val_loss: 0.1864 - val_acc: 0.9370
Epoch 48/50
 - 290s - loss: 0.0998 - acc: 0.9625 - val_loss: 0.1929 - val_acc: 0.9383
Epoch 49/50
 - 290s - loss: 0.0952 - acc: 0.9626 - val_loss: 0.1917 - val_acc: 0.9397
Epoch 50/50
 - 292s - loss: 0.0933 - acc: 0.9640 - val_loss: 0.1962 - val_acc: 0.9388

 128/2238 [>.............................] - ETA: 9s
 256/2238 [==>...........................] - ETA: 8s
 384/2238 [====>.........................] - ETA: 8s
 512/2238 [=====>........................] - ETA: 7s
 640/2238 [=======>......................] - ETA: 7s
 768/2238 [=========>....................] - ETA: 6s
 896/2238 [===========>..................] - ETA: 5s
1024/2238 [============>.................] - ETA: 5s
1152/2238 [==============>...............] - ETA: 4s
1280/2238 [================>.............] - ETA: 4s
1408/2238 [=================>............] - ETA: 3s
1536/2238 [===================>..........] - ETA: 3s
1664/2238 [=====================>........] - ETA: 2s
1792/2238 [=======================>......] - ETA: 1s
1920/2238 [========================>.....] - ETA: 1s
2048/2238 [==========================>...] - ETA: 0s
2176/2238 [============================>.] - ETA: 0s
2238/2238 [==============================] - 10s 4ms/step
Test score: 0.19619341092092635
Test accuracy: 0.9387846291864206
Saved model to disk
